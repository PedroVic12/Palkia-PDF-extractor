<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal ONS - Elite</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Padrão de fundo customizado */
        .bg-pattern {
            background-image: repeating-linear-gradient(45deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.05) 10px, transparent 10px, transparent 20px);
            background-size: 20px 20px;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans min-h-screen flex flex-col">

    <!-- Container Principal da Aplicação (View Root) -->
    <div id="app" class="flex flex-col min-h-screen"></div>

    <script>
        // ==========================================
        // 1. CONFIGURATION & MODEL (Dados e Estado)
        // ==========================================
        
        const CONFIG = {
            colors: {
                mainGreen: '#4E9A68',
                darkGreen: '#31684E'
            }
        };

        const NAV_DATA = {
            topBarLinks: [
                { label: 'PROTOCOLO ONS', href: '#' },
                { label: 'SINTEGRE', href: '#' },
                { label: 'TRABALHE NO ONS', href: '#' },
                { label: 'FALE CONOSCO', href: '#' },
                { label: 'FORNECEDORES', href: '#' },
            ],
            mainNavItems: ["SOBRE O ONS", "SOBRE O SNI", "ENERGIA NO FUTURO", "ENERGIA AMANHÃ", "ENERGIA AGORA", "RESULTADOS DA OPERAÇÃO", "CONHECIMENTO", "IMPRENSA"],
            subNavItems: ["O QUE SÃO", "VIGENTES", "BUSCA AVANÇADA", "HISTÓRICO", "MPO", "SISTEMAS", "REFERÊNCIAS"],
            footerLinks: ["Endereços", "Mapa do Site", "Privacidade e Proteção de Dados", "Membro do CIGRE"],
        };

        // Estado Global (State)
        const state = {
            activeSubTab: "MPO",
            isRegistrationOpen: false,
            modal: {
                visible: false,
                type: 'success', // 'success', 'error', 'loading'
                message: ''
            },
            formData: {
                name: '', position: '', email: '', phone: '', department: ''
            }
        };

        // ==========================================
        // 2. CONTROLLER (Lógica e Ações)
        // ==========================================

        const Controller = {
            init: () => {
                renderApp();
            },

            setTab: (tabName) => {
                state.activeSubTab = tabName;
                state.isRegistrationOpen = false;
                renderApp();
            },

            openRegistration: () => {
                state.isRegistrationOpen = true;
                // Reset form data on open
                state.formData = { name: '', position: '', email: '', phone: '', department: '' };
                renderApp();
            },

            closeRegistration: () => {
                state.isRegistrationOpen = false;
                renderApp();
            },

            updateFormData: (field, value) => {
                state.formData[field] = value;
                // No React, we re-render on every keystroke. Here, we can avoid it for performance, 
                // but for simplicity/consistency, we just update the internal state object.
                // We won't re-render the whole app on input to prevent focus loss in this simple implementation.
            },

            submitRegistration: (e) => {
                e.preventDefault();
                
                // Show loading
                state.modal = { visible: true, type: 'loading', message: 'Processando seu cadastro...' };
                renderApp();

                setTimeout(() => {
                    // Simple validation logic
                    const { email, name, department } = state.formData;
                    if (email.includes('@') && department && name) {
                        state.modal = { 
                            visible: true, 
                            type: 'success', 
                            message: `Sucesso! O funcionário ${name} foi cadastrado no departamento ${department}.` 
                        };
                    } else {
                        state.modal = { 
                            visible: true, 
                            type: 'error', 
                            message: 'Falha no cadastro. Verifique os campos.' 
                        };
                    }
                    renderApp();
                }, 1500);
            },

            closeModal: () => {
                state.modal.visible = false;
                renderApp();
            }
        };

        // ==========================================
        // 3. VIEWS (Componentes Visuais)
        // ==========================================
        // Funções que retornam strings HTML (Template Literals)

        const Views = {
            Icon: (name, size=20, classes='') => {
                // Placeholder para o Lucide processar depois
                return `<i data-lucide="${name}" width="${size}" height="${size}" class="${classes}"></i>`;
            },

            Modal: () => {
                if (!state.modal.visible) return '';
                
                const { type, message } = state.modal;
                let colorClass, title, buttonColor, iconName;

                if (type === 'success') {
                    colorClass = 'bg-green-100 border-green-400 text-green-700';
                    iconName = 'check-circle';
                    title = 'Sucesso!';
                    buttonColor = 'bg-green-600 hover:bg-green-700';
                } else if (type === 'error') {
                    colorClass = 'bg-red-100 border-red-400 text-red-700';
                    iconName = 'x-circle';
                    title = 'Atenção!';
                    buttonColor = 'bg-red-600 hover:bg-red-700';
                } else {
                    colorClass = 'bg-white border-gray-300 text-gray-800';
                    iconName = 'zap'; // Loading icon simulation
                    title = 'Aguarde...';
                }

                const showButton = type !== 'loading';

                return `
                    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 transition-opacity duration-300">
                        <div class="w-full max-w-sm rounded-xl shadow-2xl p-6 ${colorClass} border-l-4 transform transition-all duration-300 scale-100">
                            <div class="flex justify-between items-start">
                                <div class="flex items-center">
                                    ${type === 'loading' 
                                        ? `<div class="animate-spin rounded-full h-6 w-6 border-b-2 border-gray-500 mr-3"></div>` 
                                        : Views.Icon(iconName, 24, 'mr-3')}
                                    <h3 class="text-xl font-bold">${title}</h3>
                                </div>
                                ${showButton ? `<button onclick="Controller.closeModal()" class="p-1 rounded-full hover:bg-white/50 transition">${Views.Icon('x', 20)}</button>` : ''}
                            </div>
                            <p class="mt-3 text-sm font-medium">${message}</p>
                            ${showButton ? `
                                <button onclick="Controller.closeModal()" class="mt-4 w-full px-4 py-2 rounded-lg font-semibold transition shadow-md text-white ${buttonColor}">
                                    Entendido
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            },

            TopBar: () => `
                <div style="background-color: ${CONFIG.colors.darkGreen};" class="text-white text-xs py-2 px-4 border-b border-white/10 hidden lg:block">
                    <div class="max-w-7xl mx-auto flex justify-between items-center">
                        <div class="flex space-x-4">
                            ${NAV_DATA.topBarLinks.map(link => `<a href="${link.href}" class="hover:text-gray-300 transition duration-150">${link.label}</a>`).join('')}
                        </div>
                        <div class="flex items-center space-x-4">
                            ${Views.Icon('search', 16, 'cursor-pointer hover:text-yellow-400 transition')}
                            <div class="flex space-x-3">
                                ${['twitter', 'instagram', 'music', 'youtube', 'play', 'apple'].map(i => Views.Icon(i, 16, 'cursor-pointer hover:text-yellow-400 transition')).join('')}
                            </div>
                            <div class="ml-4 border-l border-white/20 pl-4 flex items-center">
                                ${Views.Icon('user', 16, 'mr-2')}
                                <button class="font-bold tracking-wide hover:underline">Entrar</button>
                            </div>
                        </div>
                    </div>
                </div>
            `,

            Header: () => `
                <header style="background-color: ${CONFIG.colors.mainGreen};" class="relative shadow-md">
                    <div class="absolute inset-0 z-0 opacity-10 pointer-events-none bg-pattern"></div>
                    <div class="relative max-w-7xl mx-auto px-4 py-4 md:py-6 flex justify-between items-center z-10">
                        <div class="flex items-center space-x-4">
                            <div class="flex flex-col items-center">
                                <div class="bg-white p-1 rounded-sm shadow-md">
                                    <div class="h-4 w-10 bg-gray-800 text-[8px] flex items-center justify-center text-white font-bold">LOGO</div>
                                </div>
                                <div class="bg-white text-xs text-red-700 font-bold p-1 mt-1 rounded-md border-b-4 border-red-700 shadow-lg leading-none">
                                    Certificado
                                </div>
                            </div>
                            <div class="text-white ml-8">
                                <h1 class="text-2xl font-extrabold tracking-tight">ONS</h1>
                                <p class="text-xs -mt-1 font-light">Operador Nacional do Sistema Elétrico</p>
                            </div>
                        </div>

                        <nav class="hidden lg:flex items-center space-x-6"> 
                            <ul class="flex space-x-6 text-sm font-semibold text-white">
                                ${NAV_DATA.mainNavItems.map(item => `
                                    <li><a href="#" class="uppercase tracking-wide hover:text-yellow-300 transition whitespace-nowrap">${item}</a></li>
                                `).join('')}
                            </ul>
                            <button onclick="Controller.openRegistration()" class="bg-yellow-400 text-gray-900 px-4 py-2 rounded-lg font-bold text-sm hover:bg-yellow-300 transition shadow-md flex items-center whitespace-nowrap">
                                ${Views.Icon('plus-circle', 16, 'mr-1')} Cadastro Elite
                            </button>
                        </nav>
                        
                        <!-- Mobile Button -->
                        <button onclick="Controller.openRegistration()" class="lg:hidden text-white p-2 border border-white rounded-md flex items-center space-x-1">
                            ${Views.Icon('plus-circle', 16)} <span class="text-sm font-bold">Elite</span>
                        </button>
                    </div>
                </header>
            `,

            SubNav: () => `
                <div style="background-color: ${CONFIG.colors.darkGreen};" class="w-full text-white shadow-xl">
                    <div class="max-w-7xl mx-auto px-4 py-4 flex flex-col md:flex-row md:justify-between md:items-center">
                        <div class="flex items-center space-x-4 pb-2 md:pb-0">
                            <h2 class="text-lg md:text-xl font-light">
                                SOBRE O ONS <span class="font-bold ml-2">PROCEDIMENTOS DE REDE</span>
                            </h2>
                            <span class="p-1 rounded-full border border-white cursor-pointer hover:bg-white hover:text-gray-900 transition">
                                ${Views.Icon('share-2', 16)}
                            </span>
                        </div>
                        <nav class="overflow-x-auto whitespace-nowrap py-1 md:py-0">
                            ${NAV_DATA.subNavItems.map(item => `
                                <button 
                                    onclick="Controller.setTab('${item}')"
                                    class="text-sm font-semibold px-4 py-2 mx-1 transition duration-150 rounded-t-lg
                                    ${state.activeSubTab === item 
                                        ? 'border-b-4 border-yellow-400 text-yellow-400' 
                                        : 'hover:border-b-4 hover:border-white/50 border-transparent text-gray-200 hover:text-white'}"
                                >
                                    ${item}
                                </button>
                            `).join('')}
                        </nav>
                    </div>
                </div>
            `,

            Content: () => `
                <main class="max-w-7xl mx-auto p-4 md:p-8 bg-white min-h-[400px]">
                    <div class="p-6 border border-gray-200 rounded-xl shadow-inner bg-gray-50">
                        <h3 class="text-xl font-semibold text-gray-700 mb-4">Seção Principal de Conteúdo</h3>
                        <p class="text-gray-600 leading-relaxed">
                            Conteúdo da aba: <strong>${state.activeSubTab}</strong>. O Operador Nacional do Sistema Elétrico (ONS) gerencia e supervisiona a operação do sistema elétrico brasileiro.
                        </p>
                        <p class="mt-4 text-sm text-gray-500">
                            Esta é uma versão Vanilla JS (MVC Pattern) simulando o React original.
                        </p>
                    </div>
                </main>
            `,

            Form: () => `
                <div class="max-w-4xl mx-auto p-4 md:p-8 bg-white shadow-2xl rounded-xl my-8 mx-4">
                    <div class="flex justify-between items-center mb-6 border-b pb-4">
                        <h1 class="text-xl md:text-3xl font-extrabold text-gray-800 flex items-center">
                            ${Views.Icon('plus-circle', 32, 'mr-3 text-green-600')}
                            Cadastro de Funcionário Elite
                        </h1>
                        <button onclick="Controller.closeRegistration()" class="text-gray-500 hover:text-red-500 transition p-2 rounded-full hover:bg-gray-100">
                            ${Views.Icon('x', 24)}
                        </button>
                    </div>

                    <form onsubmit="Controller.submitRegistration(event)" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Nome -->
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nome Completo</label>
                            <div class="relative flex items-center">
                                ${Views.Icon('user', 20, 'text-green-500 absolute ml-3')}
                                <input type="text" required class="w-full p-3 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 shadow-sm"
                                    oninput="Controller.updateFormData('name', this.value)" placeholder="Ex: João da Silva">
                            </div>
                        </div>

                        <!-- Email -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">E-mail Corporativo</label>
                            <div class="relative flex items-center">
                                ${Views.Icon('mail', 20, 'text-green-500 absolute ml-3')}
                                <input type="email" required class="w-full p-3 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 shadow-sm"
                                    oninput="Controller.updateFormData('email', this.value)" placeholder="joao@empresa.com">
                            </div>
                        </div>

                        <!-- Telefone -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Telefone</label>
                            <div class="relative flex items-center">
                                ${Views.Icon('phone', 20, 'text-green-500 absolute ml-3')}
                                <input type="tel" required class="w-full p-3 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 shadow-sm"
                                    oninput="Controller.updateFormData('phone', this.value)" placeholder="(XX) 9XXXX-XXXX">
                            </div>
                        </div>

                        <!-- Cargo -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Cargo</label>
                            <div class="relative flex items-center">
                                ${Views.Icon('briefcase', 20, 'text-green-500 absolute ml-3')}
                                <input type="text" required class="w-full p-3 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 shadow-sm"
                                    oninput="Controller.updateFormData('position', this.value)" placeholder="Gerente">
                            </div>
                        </div>

                        <!-- Departamento -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Departamento</label>
                            <select required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 shadow-sm appearance-none bg-white"
                                onchange="Controller.updateFormData('department', this.value)">
                                <option value="" disabled selected>Selecione...</option>
                                <option value="Inovacao">Inovação e Estratégia</option>
                                <option value="Operacoes">Operações Críticas</option>
                                <option value="Executivo">Setor Executivo</option>
                                <option value="P&D">P&D</option>
                            </select>
                        </div>

                        <div class="md:col-span-2 mt-4 flex justify-end space-x-4">
                            <button type="button" onclick="Controller.closeRegistration()" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-100 font-semibold">
                                Voltar
                            </button>
                            <button type="submit" class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-bold shadow-lg">
                                Cadastrar
                            </button>
                        </div>
                    </form>
                </div>
            `,

            Footer: () => `
                <footer class="w-full bg-gray-100 border-t border-gray-200 mt-auto">
                    <div class="max-w-7xl mx-auto px-4 py-6 text-gray-600 text-sm">
                        <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                            <p>&copy; Copyright 2025 ONS</p>
                            <div class="flex space-x-4">
                                ${['twitter', 'instagram', 'music', 'youtube'].map(i => `<a href="#">${Views.Icon(i, 20, 'hover:text-black')}</a>`).join('')}
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-gray-200 text-xs flex flex-wrap justify-center md:justify-start space-x-6">
                            ${NAV_DATA.footerLinks.map(l => `<a href="#" class="hover:underline">${l}</a>`).join('')}
                        </div>
                    </div>
                </footer>
            `
        };

        // ==========================================
        // 4. MAIN RENDERER (O motor da View)
        // ==========================================

        function renderApp() {
            const app = document.getElementById('app');
            
            // Construção do HTML baseada no estado
            let html = '';
            
            html += Views.Modal();
            html += Views.TopBar();
            html += Views.Header();

            if (state.isRegistrationOpen) {
                html += Views.Form();
            } else {
                html += Views.SubNav();
                html += Views.Content();
            }

            html += Views.Footer();

            // Injeção no DOM
            app.innerHTML = html;

            // Reinicializar ícones (pois o DOM mudou)
            lucide.createIcons();
        }

        // Inicializar aplicação
        Controller.init();

    </script>
</body>
</html>